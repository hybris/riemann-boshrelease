(defn unknown-vm-alert [pd]
  (sdo
    (where (service "unknown-vm.check")
      (where (state "expired")
        (:trigger pd)
        (else (:resolve pd))
      )
    )
    (where (service "unknown-vm.found")
      (changed-state {:init "ok"}
        (stable 180 :state
          (where (or (state "expired") (state "ok"))
              #(info %)
              (:resolve pd)
            (else (where (state "critical"))
              #(warn %)
              (:trigger pd)
            )
          )
        )
      )
    )
  )
)
